<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>cmod-manual</title>
        
        <meta name="robots" content="noindex" />
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "light" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div id="sidebar-scrollbox" class="sidebar-scrollbox">
                <ol class="chapter"><li class="expanded affix "><a href="ch00-00-title_page.html">Cmod Modularity Framework</a></li><li class="expanded "><a href="ch01-00-intro-to-cmod.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li><ol class="section"><li class="expanded "><a href="ch01-01-assumptions-requirements.html"><strong aria-hidden="true">1.1.</strong> Assumptions &amp; Requirements</a></li></ol></li><li class="expanded "><a href="ch02-00-tutorial-title.html"><strong aria-hidden="true">2.</strong> Cmod Tutorial</a></li><li><ol class="section"><li class="expanded "><a href="ch02-01-tutorial-getting-started.html"><strong aria-hidden="true">2.1.</strong> Getting Started</a></li><li class="expanded "><a href="ch02-02-tutorial-add-cmod.html"><strong aria-hidden="true">2.2.</strong> Add Cmod</a></li><li class="expanded "><a href="ch02-03-tutorial-find.html"><strong aria-hidden="true">2.3.</strong> Find C modules</a></li><li class="expanded "><a href="ch02-04-tutorial-generate-modules.html"><strong aria-hidden="true">2.4.</strong> Generate C modules</a></li><li class="expanded "><a href="ch02-05-tutorial-generate-files.html"><strong aria-hidden="true">2.5.</strong> Generate C files</a></li><li class="expanded "><a href="ch02-06-tutorial-test.html"><strong aria-hidden="true">2.6.</strong> Test C modules</a></li><li class="expanded "><a href="ch02-07-tutorial-clean.html"><strong aria-hidden="true">2.7.</strong> Clean C modules</a></li><li class="expanded "><a href="ch02-08-tutorial-export.html"><strong aria-hidden="true">2.8.</strong> Export C modules</a></li><li class="expanded "><a href="ch02-09-tutorial-config.html"><strong aria-hidden="true">2.9.</strong> Configure Cmod</a></li></ol></li><li class="expanded "><a href="ch03-00-customize_cmod.html"><strong aria-hidden="true">3.</strong> Customize Cmod</a></li><li class="expanded "><a href="ch04-00-project-create.html"><strong aria-hidden="true">4.</strong> Create a project with Cmod</a></li><li class="expanded "><a href="ch05-00-cmod-integrate.html"><strong aria-hidden="true">5.</strong> Add Cmod to Existing project</a></li><li class="expanded "><a href="ch06-00-command-ref.html"><strong aria-hidden="true">6.</strong> Cmod Command Reference</a></li><li class="expanded "><a href="ch06-01-faq.html"><strong aria-hidden="true">7.</strong> FAQ</a></li><li class="expanded "><a href="ch06-02-articles.html"><strong aria-hidden="true">8.</strong> Articles</a></li><li class="expanded "><a href="ch06-03-tips-tricks.html"><strong aria-hidden="true">9.</strong> Tips and Tricks</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">cmod-manual</h1>

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                            
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#cmod-modularity-framework" id="cmod-modularity-framework">Cmod Modularity Framework</a></h1>
<p><em>by Tyler Troyer</em></p>
<p>Welcome to the Cmod Manual! This guide is the primary reference for the Cmod Modularity Framework.</p>
<p>Cmod is a C development tool that simplifies project structuring and testing for C projects. The Cmod Modularity Framework is especially suited for test-driven development and embedded systems.</p>
<p>Add Cmod to your project and see how <em>managed C modules</em> invite cleaner code and enable simplified test-driven development for small projects and large development teams alike.</p>
<h1><a class="header" href="#introduction" id="introduction">Introduction</a></h1>
<p>Welcome to the Cmod guide - the primary reference for the Cmod Modularity Framework. Cmod helps you write more manageable software.</p>
<p>Managed Software is:</p>
<ul>
<li>
<p>Complete: Consistently includes all the resources needed for maintenance and testing for each and every component.</p>
</li>
<li>
<p>Organized: Consistently arranged in a methodical, clearly defined pattern, facilitating scalability and predictable us of development resources.</p>
</li>
<li>
<p>Modular: Loosely couple components can be transparently interchanged through the use of clearly defined interfaces and abstractions that free the application from the back end implementation.</p>
</li>
</ul>
<p>These project attributes are very difficult to bring to fruition in practice, but Cmod challenges the traditional excuses for poorly organized projects.</p>
<p>Cmod is a C modularity framework that enables clean project structure and testable modules.</p>
<h3><a class="header" href="#what-is-a-modularity-framework" id="what-is-a-modularity-framework">What is a modularity framework?</a></h3>
<p>A modularity framework is just a development framework (or facilitated development pattern) where C modules are first class citizens. Modular code wins the benefits of consistency, strong structure, clean interfaces, and testability.</p>
<h3><a class="header" href="#why-do-we-need-one" id="why-do-we-need-one">Why do we need one?</a></h3>
<ul>
<li>
<p>Link to &quot;./go&quot; script articles</p>
<ul>
<li>Who Is Cmod For?
<ul>
<li>Teams Of Developers</li>
<li>Students</li>
<li>Tinkerers</li>
<li>Open Source Projects</li>
<li>Companies</li>
<li>People Who Value Software Quality</li>
</ul>
</li>
<li>Who This Guide Is For</li>
<li>How to Use This Guide
<ul>
<li>Outline of shorten description of each chapter - outline or index</li>
</ul>
</li>
<li>Source Code</li>
<li>What Is It?</li>
<li>Why Was It Made?</li>
<li>Why Would I Need It?</li>
<li>Why Wouldn't I Need It?</li>
<li>Is It Easy To Try?</li>
<li>Step Learning Curve?</li>
<li>Lots To Learn?</li>
<li>Does this framework demand I change everything about how I do things?</li>
<li>Is there any additional value for anyone who writes software casually?</li>
</ul>
</li>
</ul>
<h2><a class="header" href="#assumptions--requirements" id="assumptions--requirements">Assumptions &amp; Requirements</a></h2>
<p>Cmod is based on use of a few widely available, and popular tools already found in many C project development environments:</p>
<p>Requirements for the development environment:
(These tools must be accessible from the command line / system PATH)</p>
<ul>
<li>Python 3.7.0 (no Python 2 support)</li>
<li>GNU Make</li>
<li>GCC C compiler</li>
</ul>
<p>Recommended Experience for Developer (but not required):</p>
<ul>
<li>Python basics</li>
<li>How C programs are built</li>
<li>Make / Makefiles</li>
<li>Test-Driven Development Techniques, XUnit-style tests</li>
</ul>
<h3><a class="header" href="#why-does-cmod-use-these-tools-and-not-others" id="why-does-cmod-use-these-tools-and-not-others">Why does Cmod use these tools and not others?</a></h3>
<p>Cmod makes use of these tools for a number of reasons:</p>
<ul>
<li>
<p>These tools are each available for all major OS platforms (Windows, Linux, Mac)</p>
</li>
<li>
<p>They are not new, and not obscure. They each have long proven histories of use in industry, and don't rely on any proprietary vendors. Being open-source, these tools will be around forever.</p>
</li>
<li>
<p>Maintainability is high for these tools, meaning if anything about your use of these tools needs to change, it will be fairly simple. These tools are relatively simple to understand, and you can find <em>many</em> online examples of how to adjust these tools.</p>
</li>
</ul>
<p>All in all, these requirements are simple ones. Cmod does not ask much of your development PC. Having Make, a C compiler, and an up-to-date to Python 3.8 installation (Python 2 is deprecated) is all basic stuff to have.</p>
<p>That said, here are the Debian/Ubuntu commands for checking for correction installation:</p>
<pre><code class="language-shell">$ python3.8 --version
Python 3.8.0
</code></pre>
<pre><code class="language-shell">$ make --version
GNU Make 4.1
Built for x86_64-pc-linux-gnu
Copyright (C) 1988-2014 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
</code></pre>
<pre><code class="language-shell">$ gcc --version
gcc (Debian 6.3.0-18+deb9u1) 6.3.0 20170516
Copyright (C) 2016 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
</code></pre>
<p>All good to go? If not you need to get these tools installed and added to your system PATH.</p>
<h1><a class="header" href="#cmod-tutorial" id="cmod-tutorial">Cmod Tutorial</a></h1>
<p>With your system requirements in place, let’s start the Cmod demo!</p>
<p>In this chapter, we’ll do a few things:</p>
<ul>
<li>Download and build a simple C project</li>
<li>Add Cmod to demo project</li>
<li>Practice using Cmod to scale the project in a modular way</li>
</ul>
<h1><a class="header" href="#getting-started" id="getting-started">Getting Started</a></h1>
<h3><a class="header" href="#clone-the-demo-project" id="clone-the-demo-project">Clone the Demo Project</a></h3>
<p>To start, clone the Cmod demo project to a directory called &quot;cmod-demo&quot;. We'll use this project for demonstration purposes only, so feel free to save it somewhere temporary.</p>
<pre><code class="language-shell">$ git clone http://github.com/troyerta/cmod-demo cmod-demo
</code></pre>
<p>After cloning, navigate to the demo project directory and note the contents:</p>
<pre><code class="language-shell">$ cd cmod-demo
$ tree
.
├── bar
│   ├── bar.c
│   └── bar.h
├── foo
│   ├── foo.c
│   └── foo.h
├── main.c
├── Makefile
└── README.md

2 directories, 7 files
</code></pre>
<p>Some observations:</p>
<ul>
<li>There are two C modules: &quot;foo&quot; and &quot;bar&quot;</li>
<li>We have a main source file</li>
<li>Given the presence of a Makefile, we assume we can build the project with GNU Make.</li>
</ul>
<h3><a class="header" href="#examine-the-program" id="examine-the-program">Examine the Program</a></h3>
<p>Opening the project with your favorite code editor, you'll see how the demo program is organized and what it does.</p>
<p>The main program simply calls functions from the &quot;foo&quot; and &quot;bar&quot; modules, telling us that they are compiled and linked correctly.</p>
<p>Looking into the Makefile shows us that any .c sources down to 4 directories deep will be compiled and linked into the program.</p>
<p>Lastly, one of the Makefile's rules will run the program after the compiling and linking with GCC.</p>
<h3><a class="header" href="#build-and-run" id="build-and-run">Build and Run</a></h3>
<p>If you have Make and GCC installed, go ahead and give this a try:</p>
<pre><code class="language-shell">$ make
Hello world!
Foo!
Bar!
</code></pre>
<p>Of course, you can modify the Makefile to call a different C compiler if you find it necessary to do so. To Cmod, it doesn't matter which C compiler you build the application with. But for this demo, there no reason to assume that Cmod can't use GCC as well.</p>
<p>If you had to change the compiler in the Makefile to build and run the program successfully, take note. You will need make a similar adjustment later in this tutorial.</p>
<p>Building an running a Makefile-based C project like this is all basic stuff if you understand the how to build C programs already. The point of this step was to convince you that you've started from a &quot;working place&quot; going forward, as a test of our tools. If you would rather delete the Makefile and build the demo program with your own tools, go for it. Cmod doesn't actually care about how you build your application. We'll see why in later steps.</p>
<h3><a class="header" href="#add-cmod-to-the-project" id="add-cmod-to-the-project">Add Cmod to the Project</a></h3>
<p>If you're convinced there's no magic happening here, then let's add Cmod to our demo project.</p>
<p>Clone Cmod somewhere nearby our demo project:</p>
<pre><code class="language-shell">$ git clone https://github.com/troyerta/cmod.git cmod
</code></pre>
<h3><a class="header" href="#examine-cmod" id="examine-cmod">Examine Cmod</a></h3>
<p>Looking inside the cmod directory, we see the following:</p>
<p>FIX</p>
<pre><code class="language-shell">$ cd cmod &amp;&amp; tree
cmod/
|
├── cmod
└── tools/
    └── cmod/
        ├── python_file.py
        ├── another_one.py
        └── ..
</code></pre>
<p>Apparently, Cmod is just a collection of Python scripts and classes.</p>
<p>Now that we have both the cmod sources and a demo project, let's add Cmod to the project. In this case, the simplest way to achieve this is to copy the &quot;<strong>cmod</strong>&quot; file and the entire &quot;<strong>tools/</strong>&quot; directory to our project's root directory.</p>
<p>Make sure your demo project now looks like this:</p>
<pre><code class="language-shell">$ tree
cmod-demo/
|
├── foo/
|   ├── foo.c
|   └── foo.h
├── bar/
|   ├── bar.c
|   └── bar.h
├── main.c
├── cmod
├── Makefile
└── tools/
    └── cmod/
        ├── python_file.py
        ├── another_one.py
        └── ..
</code></pre>
<h3><a class="header" href="#build-cmods-virtual-environment" id="build-cmods-virtual-environment">Build Cmod's Virtual Environment</a></h3>
<p>Lastly, we'll make a Python3.8 Virtual Environment <em>in</em> our demo project. It will contain the Python executable <em>for this project</em>.</p>
<p><strong>Why would we want to do this?</strong></p>
<p>Python's <em>virtual environment</em> feature actually builds and locally stores an <em>instance</em> of Python 3.8 as an executable binary in some directory you specify. This prevents your coworkers and collaborators from having to use identical Python installations and Host Operating Systems on their development PCs.</p>
<p>This has a couple negative consequences to note:</p>
<p>The virtual environment must be deleted and then remade each time the project directory is moved or copied to a new location on disk.</p>
<p>The exact mechanisms are not anything to mind, just run cmod venv to rebuild your venv at anytime.</p>
<p>Build the cmod venv so that we can keep our use of Python local to the project. (Be sure to use the exact paths specified here)</p>
<pre><code>$ python3.8 -m venv tools/cmod/venv
</code></pre>
<p>Anytime you make a venv, be sure to add the venv directory to the .gitignore list if you are using git to track your project.</p>
<pre><code class="language-shell">$ echo 'tools/cmod/venv' &gt;&gt; .gitignore
</code></pre>
<h3><a class="header" href="#test-cmod" id="test-cmod">Test Cmod</a></h3>
<p>Mark the cmod file as &quot;executable&quot;. This is the main entry point for any Cmod command we invoke.</p>
<pre><code>$ chmod 774 cmod
</code></pre>
<p>Test the Cmod executable.</p>
<pre><code class="language-shell">$ ./cmod help
</code></pre>
<p>Given the &quot;help&quot; command is working, we note a few interesting things about Cmod:</p>
<ul>
<li>Cmod gets &quot;integrated&quot; into a project, not installed to your computer</li>
<li>Cmod will not add environment variables to your PATH, and won't copy itself to your system directories</li>
<li>Cmod is not made &quot;for&quot; Unix, Windows, or OSx - it's made for your project</li>
<li>Cmod lives with your project.</li>
<li>Each instance of Cmod can be modified to suit the special needs of it's host project</li>
</ul>
<h3><a class="header" href="#invoking-cmod" id="invoking-cmod">Invoking Cmod</a></h3>
<p>When you run Cmod to do &quot;module things&quot;, the &quot;cmod&quot; file is what you execute.</p>
<pre><code class="language-shell">$ ./cmod &lt;command&gt;
</code></pre>
<p>A file is normally executed with &quot;./&quot; on Unix systems.</p>
<p>For commonly-used scripts, it can be nice to add an alias to your terminal to shorten the invocation command.</p>
<p>A good alias to start with is abbreviating ./cmod to just cmod.</p>
<p>This can be done by adding the following to your .bashrc:</p>
<p>.bashrc:</p>
<pre><code>alias cmod='./cmod'
</code></pre>
<p>Now you can invoke cmod by with a slightly simpler command:</p>
<pre><code class="language-shell">$ cmod &lt;command&gt;
</code></pre>
<p>Additional aliases will be suggested later in the tutorial.</p>
<h3><a class="header" href="#summary" id="summary">Summary</a></h3>
<p>To recap, this is all we've done so far:</p>
<ul>
<li>Add Cmod files to a dumb sample project</li>
<li>Setup cmod's Python virtual environment</li>
<li>Ran ./cmod help too make sure the cmod venv works</li>
<li>Added a simple &quot;./cmod&quot; alias</li>
</ul>
<h1><a class="header" href="#find-c-modules" id="find-c-modules">Find C modules</a></h1>
<h1><a class="header" href="#generate-c-modules" id="generate-c-modules">Generate C modules</a></h1>
<p>Let's start by generating an instance of Cmod's first-class citizens: a C module.</p>
<p>Use this command to generate an example &quot;accelerometer&quot; module: Read the output before pressing &quot;ENTER&quot;</p>
<pre><code>$ cmod generate --module=accel
</code></pre>
<p>Cmod shows you a preview of the files it's planning to generate for your module.</p>
<p>Each of the filenames and filepaths shown in this preview are configurable, and can be changed suite your project's naming scheme, organizational requires, or any additional preferences. See &quot;Module Configuration&quot; for details.</p>
<p>If you messed up your module's name, you have a chance to cancel the operation by pressing &quot;n&quot; for &quot;no&quot;.</p>
<p>Press &quot;ENTER&quot; from here to make your module.</p>
<p>Using your favorite IDE, examine your new module's contents. You'll see that a module is just a directory with a templated arrangement of C sources (.c) and headers (.h). This means that distinguishing a directory in your project from a module becomes a little tricky. We need some way to mark each module directory as distinct from other project directories.</p>
<p>Cmod's default solution is to identify any directory with a &quot;unit_test&quot; directory within it as a module. The identifying marker file or directory can be configured as anything else, since there are plentry of reasons why the default marker may not suit your project. See &quot;Module Configuration&quot; for details.</p>
<p>Since the module we just created contains this marker, cmod can find the &quot;accel&quot; module anytime we need to perform module tasks in our project. You can confirm that Cmod is aware of your module:</p>
<pre><code>$ mkdir not_a_module
$ cmod list
</code></pre>
<p>You'll see that cmod will ignore any directory that does not contain the module marker.</p>
<p>Cmod's module awareness works for nested modules too, generate some additional modules before continuing:</p>
<pre><code>accel/lism43566d

wifi

graphics/primitives/circle

graphics/primitives/rectangle
</code></pre>
<p>While Cmod commands are memorable and tend to be complete words specifying actions, they can still be a mouthful to type each time. You can use &quot;$ cmod gen -m=module_path&quot; if you prefer to be brief. See &quot;Cmod Command Aliases&quot; page for variations of each command and tips for calling into cmod with brevity.</p>
<p>Note that the modules we created are named by the deepest directory in the path we specify. This means that &quot;circle&quot; and &quot;rectangle&quot; are modules, but &quot;primitives&quot; is just a directory. This also means that the lism43566d module just happens to live in the accel module, treating it like just another directory. The two modules actually have little to do with each other, with is a favorable property of modular code. In this case, it could make sense to nest these two modules in the name of organization. We could choose to never use nested modules by simply moving them all to the project directory for a flat project structure, or just generating them there in the first place. Cmod does not care about how your choose to organize your project.</p>
<p>Now list out your modules again to confirm &quot;primitives&quot; is not a module:</p>
<pre><code>$ cmod list
</code></pre>
<p>If you want to be more choosy with the modules to look for, you can specify a different root module to search from:</p>
<pre><code>$ cmod list --m=graphics
</code></pre>
<p>While it may be nice to get lists of modules, this command is not very useful to the software developer. Understanding this command gives insight to how Cmod sees and manages your project.</p>
<p>Projects often contain a mixture of directories containing source code, libraries, tools, scripts, and documentation. Cmod includes a more useful command that lets you view your project's modules, along with the relationships between them. Think of it as way to filter out anything that isn't managed by Cmod.</p>
<pre><code>$ cmod tree
</code></pre>
<p>Just like with the list command, you can specify a different root module to draw the tree from:</p>
<pre><code>$ cmod tree --m=graphics
</code></pre>
<p>One nice thing about the Cmod interface is the carry-over of flags used for each of the commmands. Specifying a module with &quot;--m=&quot; applies a command to a single module. Adding the &quot;--r&quot; flag applies the command to the specified module, and any modules under it, recursively. Leaving out the &quot;--m=&quot; command applies commands to the entire project.</p>
<h1><a class="header" href="#generate-c-files" id="generate-c-files">Generate C files</a></h1>
<h1><a class="header" href="#test-c-modules" id="test-c-modules">Test C modules</a></h1>
<p>Another most-important command is the test command. This is your go-to command when running your Test-Driven Development cycles, and when you run you Continuous Integration scripts.</p>
<pre><code>$ cmod test
</code></pre>
<p>Again, try specifying a module to test just that one, then try adding the &quot;--r&quot; flag to test all the nested modules too.</p>
<p>This test command does a lot of things. Cmod is reading the template test source files included in the generated modules, and generating a test runner source file from the tests it finds. It then invokes &quot;Make&quot; on the module's mini-Makefile, taking advantage of the Cmod Makefile found in &quot;tool/cmod/Makefile&quot;. This Makefile builds an executable test program, runs it, and then stores the test output in the results text file. Cmod then parses the results file, and reports back the results in the terminal.</p>
<p>For now, this only works &quot;out-of-the-box&quot; with the Unity test harness included with Cmod. If you prefer to use a different harness, refer to the &quot;Supporting a Test Harness&quot; page for details.</p>
<p>Each module's unit test build/run cycle occurs in a new process, so if a module contains build errors, or crashes in a test, the other module tests remain unaffected.</p>
<p>If you're familiar with the Unity test harness, go ahead and add some passing and failing tests to a module and test that module with varying verbosity levels to identify one that you like. You can use values 0-7 here:</p>
<pre><code>$ cmod test --m=wifi --v=N
</code></pre>
<p>Again, if you don't like the test source file name or location, or even the generated code style, remember to review the &quot;Cmod Configuration&quot; page for walkthroughs that demonstrate module customization.</p>
<p>When you find a verbosity level you like, you can set it as the default in the config.ini, so you don't have to specify in the test commadn anymore. You can always specify a new level in the command to override the default. See the &quot;Cmod Configuration&quot; page for descriptions of the verbosity levels.</p>
<h1><a class="header" href="#clean-c-modules" id="clean-c-modules">Clean C modules</a></h1>
<h1><a class="header" href="#export-c-modules" id="export-c-modules">Export C modules</a></h1>
<h1><a class="header" href="#configure-cmod" id="configure-cmod">Configure Cmod</a></h1>
<h1><a class="header" href="#customize-cmod" id="customize-cmod">Customize Cmod</a></h1>
<ul>
<li>
<p>Not a Cmod project - just a project with Cmod</p>
<ul>
<li>Cmod is &quot;added&quot;, not installed</li>
</ul>
</li>
<li>
<p>Download Cmod files</p>
</li>
<li>
<p>Make the venv</p>
</li>
<li>
<p>Fill in config.ini</p>
</li>
<li>
<p>Make a module</p>
</li>
<li>
<p>Make another module</p>
</li>
<li>
<p>Make a nested module</p>
</li>
<li>
<p>Run tests</p>
</li>
<li>
<p>Do a TDD cycle</p>
<ul>
<li>Make a test list</li>
<li>Make a failing test</li>
<li>Make the test pass</li>
</ul>
</li>
<li>
<p>Format test results</p>
<ul>
<li>Redirect and save results somewhere else</li>
</ul>
</li>
<li>
<p>Starting a new project with Cmod from scratch</p>
</li>
</ul>
<pre><code class="language-text">my_project/
|
├── io.c
├── io.h
├── application.c
├── application.h
├── os.c
├── os.h
├── stm32f103re.h
├── utils/..
├── widget.c
├── tools
├── README.md
├── cmod
├── Makefile
└── .gitignore
</code></pre>
<p>Add Cmod to an existing project</p>
<p>Use getting started page as a template here.</p>
<ul>
<li>Integrating Cmod to an already-existing project</li>
</ul>
<h1><a class="header" href="#quick-reference" id="quick-reference">Quick Reference</a></h1>
<p>But why do we need to have a python virtual environment?</p>
<p>This is an important abstraction layer of sorts. Using a Python virtual environment (venv) ensures your project's use of python and and python libraries and modules does not force any PC developing on your project to have those modules and libraries installed system-wide. This allows all your team members to use their own host-OS, reducing the number of third party requirements for building your project.</p>
<p>Python allows this with it's venv module, which creates a local instance of a Python installation <strong>in the project</strong> for the development on this project on this machine. But this directory and all it's binary blobs are not added to source control so your peers or coworkers can clone the project, and setup a local Python installation instance (virtual environment) that works on their machine and host OS. It only takes a couple terminal commands to do this, so once your project is cloned, it's just a couple more</p>
<p>Python scripts are a little less portable than Perl or Ruby scripts can be. I attribute this to Python's relative instability as a language over the last 10 years. Python's popularity surge in this time came with a number of features and changes that broke older Python scripts, but there were also a number of great modules and utilities that make Python a joy to use. It has become much more stable as a language to use since then. So there is something to be said for having an updated installation of Python. 3.8 is recommended for CMod. But, if you need to use a legacy version instead, you can specify the version you need with the venv command.</p>
<p>Cmod is a collection of python scripts and classes that support structured software development techniques,
which in turn, simplifies other tasks like unit testing, TDD, and general code maintenance. Once you try it out
with a simple demo project, you'll see why this may be especially helpful for embedded systems projects using the
C language.</p>
<p>Here's the main thing you need to know about Cmod before you integrate it into a project:
Cmod allows you to manage your project as a collection of testable modules.</p>
<p>Cmod's definition of a module is just a directory in your project that contains a special file marking it as so.
This lets you populate your modules with as much or as little production code as you like, since there is no
agreed-upon definition of the heavily abused term &quot;module&quot;.</p>
<p>With Cmod's module definition, it is advisable to start organizing your code using a block diagram. It should show your project's
varying code units, and how they relate to each other in the project directory - not necessarily how they might depend on one-another.</p>
<p>Block diagrams add a large number of organizational benefits to your project - even before you have any code written, so
take some time to draw yourself a picture of what you want to codebase to look and feel like.</p>
<p>Use the back of a napkin to start, or just type out your desired project directory tree to start.</p>
<p>For formal projects, Gliffy is a good option for professional-looking visualization.</p>
<p>Before we can do anything with your project's modules, you will also need to spend some time describing your
project preferences to Cmod by filling out any relevant fields you find in config.txt. There is a more detailed
guide about this here:</p>
<p>After your config.ini file is more customized apart from the default settings, you can generate some C modules
for your project. Cmod will follow your project description in config.ini, and produce ready-to-test
modules that fit your project's coding style and use your preferred unit test harness!</p>
<pre><code>./cmod generate --module=moduleA
</code></pre>
<p>or simply</p>
<pre><code>./cmod gen -m=moduleA
</code></pre>
<p>or more simply, using the recommended bash aliases:</p>
<pre><code>gen -m=moduleA
</code></pre>
<p>This is about as good as it gets for frameworks in the C language. Simple code/file generation will
always have subjective results, so be sure you customize these python functions (.....) until you're happy with
the appearance and names of the generated module files.</p>
<p>Make a child-module (nested module) by specifying a nested path:</p>
<pre><code>gen -m=moduleA/subcategory/submoduleA
</code></pre>
<p>In this case, submoduleA is a separate and distinct module from moduleA, and subcategory is just a directory in between them.
Cmod does not see it as a module. These 2 modules are nested, and that's all. There is nothing more we need to know about them.
There is no dependency chain implied here in this structure, it is just for organizational form. You COULD allow a nested module
structure imply a dependency chain, but there are reasons why this is not typically done.</p>
<p>Things to do with your codebase once it's organized into modules: &quot;Cmod things&quot;</p>
<p>These commands will work with &quot;empty&quot; modules, since Cmod generates a default
test case automatically. So if you don't have your code moved into your module
directories yet, don't worry. Just generate some &quot;blank&quot; modules somewhere if you
just want to experiment with the Cmod command base.</p>
<p>The &quot;help&quot; command should be your go-to when you need a quick reminder of how to use cmod.
It's output was thoughfully arranged to be both optimal and pleasant to read. Please enjoy
using it.</p>
<pre><code>./cmod --help
./cmod -help
./cmod --h
./cmod -h
</code></pre>
<p>The &quot;list&quot; command can be called at any time. All it does is read your project files, and show them in a condensed, helpful way</p>
<pre><code>./cmod list                                           -- List out all the modules under the project root directory
./cmod list --module=MODULE_A/module_b                -- List out all the modules under the MODULE_A/module_b
./cmod list --m=my_mod --s=?                          --List all the test suites under the 'my_mod' module
./cmod list --m=my_mod --s=TEST_MY_MOD_SUITE --t=?    - List all the test cases under the TEST_MY_MOD_SUITE in my_mod module
./cmod list --m=my_mod --s=? --t=?  - List all the test suites and their test cases under the my_mod module
</code></pre>
<p>The &quot;tree&quot; command works identically to the &quot;list&quot; command, but the output is always formatted with a directory tree output style.</p>
<p>The &quot;build&quot; command runs the Makefile in each module, telling Make to compile, and link the module tests, but not to run them.</p>
<pre><code>./cmod build --m=module
</code></pre>
<p>The &quot;report&quot; command can also be called at any time, but it's mostly useful when your modules have test results to show.</p>
<pre><code>./cmod report
./cmod report --module=MODULE_A/module_b
./cmod report --module=MODULE_A/module_b --s=TEST_MY_MODULE_B_SUITE
./cmod report --module=MODULE_A/module_b --s=TEST_MY_MODULE_B_SUITE --t=TestMySpecificTestCase
./cmod report
./cmod report
./cmod report
</code></pre>
<p>The &quot;test&quot; command can be ran at any time. It assumes your test builds compile and run.</p>
<pre><code>./cmod test                   -- Build and Run all tests found in the project
./cmod test --m=module        -- Build and Run all tests found in the module
./cmod test --m=module --r    -- Build and Run all tests found in the module, and in all child modules
./cmod test --v=2             -- Build and Run all tests found in the project, reporting the results with a verbosity level of 2. [0-7 are valid]
./cmod test --m=module --suite=MODULE_TEST_GROUP -- Build and Run all test cases found in the module's test group called &quot;MODULE_TEST_GROUP&quot;
./cmod test --m=module --s=MODULE_TEST_GROUP --case=TestMyCaseDoesNotFail   -- Build and Run only the specified test case, requires the module and suite parameters
</code></pre>
<p>The &quot;stat&quot; command runs a few tools and returns some interesting metrics about your project modules</p>
<pre><code>./cmod stat
./cmod stat --m=module
./cmod stat --m=module --r
</code></pre>
<p>The &quot;tdd&quot; is a quick way to do several things at once, which helps the developer doing Test-Driven Development
It is a quick way to run</p>
<pre><code>./cmod build --m=path/to/module
./cmod test --m=path/to/module
./cmod report --m=path/to/module
</code></pre>
<p>Instead, just use</p>
<pre><code>./cmod tdd --m=path/to/module
</code></pre>
<p>Each build-test-report sequence will occur one at a time in a separate process, for each module specifed:</p>
<pre><code>./cmod tdd --m=path/to/module --r
</code></pre>
<p>OpenProcess:
./cmod build --m=path/to/module
./cmod test --m=path/to/module
./cmod report --m=path/to/module
CloseProcess</p>
<p>OpenProcess:
./cmod build --m=path/to/module/submod1
./cmod test --m=path/to/module/submod1
./cmod report --m=path/to/module/submod1
CloseProcess</p>
<p>OpenProcess:
./cmod build --m=path/to/module/submod2
./cmod test --m=path/to/module/submod2
./cmod report --m=path/to/module/submod2
CloseProcess</p>
<p>If you want to quickly test your entire project, this is probably the fastest way:</p>
<pre><code>./cmod td
</code></pre>
<p>This command also works within any module directory. So I you need to focus your development
attention with only 1 module for a while, just navigate to the module and run:</p>
<pre><code>./td
</code></pre>
<p>This will run the cmod tdd sequence for the local module only - enabling quick and easy TDD cycles.</p>
<h1><a class="header" href="#faq" id="faq">FAQ</a></h1>
<h3><a class="header" href="#what-are-the-supported-platforms" id="what-are-the-supported-platforms">What are the supported platforms?</a></h3>
<p>Since Cmod's dependencies are intentionally few and simple, any development platform that runs Python 3.8x and GNU Make can take advantage of Cmod as a development tool.</p>
<h3><a class="header" href="#where-can-i-report-a-bug" id="where-can-i-report-a-bug">Where can I report a bug?</a></h3>
<p>What bugs? Just kidding. Cmod is not Developed with a Test-Driven process. So if you notice that Cmod needs some work, you can always submit a pull request at the main repository.</p>
<h3><a class="header" href="#how-is-cmod-licensed" id="how-is-cmod-licensed">How is Cmod licensed?</a></h3>
<p>Cmod is shared under an <a href="https://opensource.org/licenses/ISC">ISC License</a>.</p>
<h3><a class="header" href="#is-cmod-open-source" id="is-cmod-open-source">Is Cmod open source?</a></h3>
<p>By implication from the license, Cmod is open source and always will be.</p>
<h3><a class="header" href="#how-can-i-contribute-to-cmod" id="how-can-i-contribute-to-cmod">How can I contribute to Cmod?</a></h3>
<p>Through our strict vetting process, you may be found worthy as a contributor. The process has a number of steps:</p>
<ol>
<li>
<p>Submit a pull request with kindess.</p>
</li>
<li>
<p>Don't be a butt. (Remember, snobs don't get jobs)</p>
</li>
<li>
<p>Humbly submit to a code review - with gratefulness.</p>
</li>
<li>
<p>Take credit for being helpful.</p>
</li>
<li>
<p>That's it!</p>
</li>
</ol>
<ul>
<li>FAQ
<ul>
<li>Can you explain Cmod's license? BSD</li>
</ul>
</li>
<li>Why TDD?</li>
<li>TDD tutorial for generic embedded system project</li>
<li>Adding mocks with FFF</li>
<li>Why not Ceedling?</li>
<li>Why not bare-metal Unity?</li>
<li>Why not CppuTest?</li>
<li>Why write and use a style guide?</li>
<li>State of current dev tools for embedded C developers
<ul>
<li>Why we can/should do better, and How</li>
<li>LIT review of available frameworks</li>
</ul>
</li>
</ul>
<table><thead><tr><th>Sample Table</th><th>std</th><th>rustc</th><th>cargo</th><th>notes</th></tr></thead><tbody>
<tr><td><code>x86_64-unknown-linux-musl</code></td><td>✓</td><td></td><td></td><td>64-bit Linux with MUSL</td></tr>
<tr><td><code>arm-linux-androideabi</code></td><td>✓</td><td></td><td></td><td>ARM Android</td></tr>
<tr><td><code>arm-unknown-linux-gnueabi</code></td><td>✓</td><td>✓</td><td></td><td>ARM Linux (2.6.18+)</td></tr>
<tr><td><code>arm-unknown-linux-gnueabihf</code></td><td>✓</td><td>✓</td><td></td><td>ARM Linux (2.6.18+)</td></tr>
<tr><td><code>aarch64-unknown-linux-gnu</code></td><td>✓</td><td></td><td></td><td>ARM64 Linux (2.6.18+)</td></tr>
<tr><td><code>mips-unknown-linux-gnu</code></td><td>✓</td><td></td><td></td><td>MIPS Linux (2.6.18+)</td></tr>
<tr><td><code>mipsel-unknown-linux-gnu</code></td><td>✓</td><td></td><td></td><td>MIPS (LE) Linux (2.6.18+)</td></tr>
</tbody></table>
<h1><a class="header" href="#tips-and-tricks" id="tips-and-tricks">Tips and Tricks</a></h1>
<ul>
<li>Basically a how-to reference:
<ul>
<li>Switch/select a new test harness</li>
<li>Modify test output on console and in logs</li>
<li>Define a file name scheme for Cmod</li>
<li>Define a code style/format for Cmod</li>
<li>How set host compiler, cross compiler, and build flags</li>
</ul>
</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>

        

        

        
        
        
        <script type="text/javascript">
            window.playpen_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        
        
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
        
        

    </body>
</html>
